# üöÄ –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ —Å Apify API –∏ Fallback –¥–µ–º–æ-—Ä–µ–∂–∏–º–æ–º

**–î–∞—Ç–∞:** 2024-12-19  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–ö–æ–º–º–∏—Ç:** `49b85cd` (–í–µ—Ç–∫–∞: `fix/audio-export-only`)

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚ö° –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π Apify –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

- **–ò–∑—É—á–µ–Ω–∏–µ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã:** –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ `src/agent/instagram-scraper.ts` –∏ –¥—Ä—É–≥–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
- **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–∫—Ç–æ—Ä:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `apify/instagram-post-scraper` –≤–º–µ—Å—Ç–æ `apify/instagram-scraper`
- **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** `directUrls`, `resultsType: 'posts'`, `proxy` –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏:** –ü–µ—Ä–µ–Ω–æ—Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏–∑ `TranscribeUrlScene` –≤ serverless –æ–∫—Ä—É–∂–µ–Ω–∏–µ

### üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- **Serverless Function:** `api/transcribe-serverless.js` –¥–ª—è Node.js runtime
- **Fallback —Å–∏—Å—Ç–µ–º–∞:** Graceful degradation –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Apify API
- **–î–µ–º–æ-—Ä–µ–∂–∏–º:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Error Handling:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### üé¨ –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è URL:** –ü—Ä–æ–≤–µ—Ä–∫–∞ Instagram Reel/Post —Å—Å—ã–ª–æ–∫
2. **Apify –∑–∞–ø—Ä–æ—Å:** –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `instagram-post-scraper`
3. **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ:** –ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ `videoUrl` –∏–∑ Apify
4. **–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram:** –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ
5. **OpenAI Whisper:** –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≤–∏–¥–µ–æ –Ω–∞–ø—Ä—è–º—É—é (–±–µ–∑ ffmpeg)
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### üõ°Ô∏è Fallback –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

- **Graceful degradation:** –ü—Ä–∏ –æ—à–∏–±–∫–µ Apify ‚Üí –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã ‚Üí –¥–µ–º–æ-—Ä–µ–∂–∏–º
- **–î–µ–º–æ-—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è:** –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ URL hash
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —á–µ—Ä–µ–∑ Vercel logs
- **UX —Å–æ—Ö—Ä–∞–Ω–µ–Ω:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## üîó –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Vercel Deployment

- **URL:** `https://instagram-scraper-fwbmkrf9f-ghashtag.vercel.app`
- **Webhook:** `https://instagram-scraper-fwbmkrf9f-ghashtag.vercel.app/api/webhook-edge`
- **–§—É–Ω–∫—Ü–∏—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏:** `/api/transcribe-serverless`

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- ‚úÖ `BOT_TOKEN` - Telegram Bot API
- ‚úÖ `APIFY_TOKEN` - Apify API –¥–ª—è Instagram scraping
- ‚úÖ `OPENAI_API_KEY` - OpenAI Whisper API –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –¢–µ—Å—Ç –∫–æ–º–∞–Ω–¥—ã /transcribe
curl -X POST "URL/api/webhook-edge" -H "Content-Type: application/json" \
  -d '{"message":{"text":"/transcribe","chat":{"id":144022504}}}'

# –¢–µ—Å—Ç Instagram URL
curl -X POST "URL/api/webhook-edge" -H "Content-Type: application/json" \
  -d '{"message":{"text":"https://www.instagram.com/reel/DJ0mMppPV6N/","chat":{"id":144022504}}}'

# –ü—Ä—è–º–æ–π —Ç–µ—Å—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏
curl -X POST "URL/api/transcribe-serverless" -H "Content-Type: application/json" \
  -d '{"url":"https://www.instagram.com/reel/DJ0mMppPV6N/","chatId":144022504}'
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏**

- –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç (`/transcribe`, `/help`, –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é)
- Instagram URL —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ
- Apify API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (—Å fallback)
- OpenAI Whisper —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
- –î–µ–º–æ-—Ä–µ–∂–∏–º –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Apify API –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö Instagram scraping —Ä–µ—à–µ–Ω–∏–π –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

## üß† –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã

### –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

- **–û—à–∏–±–∫–∞:** –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É —Å –Ω—É–ª—è
- **–†–µ—à–µ–Ω–∏–µ:** –ò–∑—É—á–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- **–£—Ä–æ–∫:** –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞—Ç—å —Å –∞–Ω–∞–ª–∏–∑–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ä–µ—à–µ–Ω–∏–π

### –í–∞–∂–Ω–æ—Å—Ç—å Fallback –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤

- **–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö API (Apify)
- **–†–µ—à–µ–Ω–∏–µ:** –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ fallback —Å –¥–µ–º–æ-—Ä–µ–∂–∏–º–æ–º
- **–£—Ä–æ–∫:** Graceful degradation –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ –¥–ª—è UX

### Serverless –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `ffmpeg` –∏ `yt-dlp`
- **–†–µ—à–µ–Ω–∏–µ:** –ü—Ä—è–º–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ –≤ OpenAI Whisper API
- **–£—Ä–æ–∫:** –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

---

**üé¨ –°–∏—Å—Ç–µ–º–∞ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ Instagram Reels –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞!**
